print("=" * 70)
print("é€šé“è½¬æ¢åŸç†ï¼šå®Œå…¨ä¸€æ ·ï¼")
print("=" * 70)

print("""
æ¡ˆä¾‹1: MNISTé»‘ç™½å›¾ç‰‡ (LeNet)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
è¾“å…¥: 1é€šé“ (ç°åº¦å›¾)ï¼Œ28Ã—28
Conv2d(in_channels=1, out_channels=6, kernel_size=5)

å·ç§¯æ ¸é…ç½®:
  - 6ä¸ªå·ç§¯æ ¸ â† è¾“å‡º6é€šé“
  - æ¯ä¸ªå·ç§¯æ ¸å¤§å°: 5Ã—5Ã—1
                         â†‘
                    è¾“å…¥åªæœ‰1é€šé“

è¿‡ç¨‹:
  å·ç§¯æ ¸1 [5Ã—5Ã—1] â†’ è¾“å‡ºç‰¹å¾å›¾1
  å·ç§¯æ ¸2 [5Ã—5Ã—1] â†’ è¾“å‡ºç‰¹å¾å›¾2
  å·ç§¯æ ¸3 [5Ã—5Ã—1] â†’ è¾“å‡ºç‰¹å¾å›¾3
  å·ç§¯æ ¸4 [5Ã—5Ã—1] â†’ è¾“å‡ºç‰¹å¾å›¾4
  å·ç§¯æ ¸5 [5Ã—5Ã—1] â†’ è¾“å‡ºç‰¹å¾å›¾5
  å·ç§¯æ ¸6 [5Ã—5Ã—1] â†’ è¾“å‡ºç‰¹å¾å›¾6

ç»“æœ: (1, 1, 28, 28) â†’ (1, 6, 24, 24)
      â†‘              â†‘
   è¾“å…¥1é€šé“      è¾“å‡º6é€šé“ âœ“


æ¡ˆä¾‹2: ImageNetå½©è‰²å›¾ç‰‡ (DenseNet)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
è¾“å…¥: 3é€šé“ (RGB)ï¼Œ224Ã—224
Conv2d(in_channels=3, out_channels=64, kernel_size=7)

å·ç§¯æ ¸é…ç½®:
  - 64ä¸ªå·ç§¯æ ¸ â† è¾“å‡º64é€šé“
  - æ¯ä¸ªå·ç§¯æ ¸å¤§å°: 7Ã—7Ã—3
                          â†‘
                    è¾“å…¥æœ‰3é€šé“(RGB)

è¿‡ç¨‹:
  å·ç§¯æ ¸1 [7Ã—7Ã—3] â†’ è¾“å‡ºç‰¹å¾å›¾1
  å·ç§¯æ ¸2 [7Ã—7Ã—3] â†’ è¾“å‡ºç‰¹å¾å›¾2
  ...
  å·ç§¯æ ¸64 [7Ã—7Ã—3] â†’ è¾“å‡ºç‰¹å¾å›¾64

ç»“æœ: (1, 3, 224, 224) â†’ (1, 64, 112, 112)
      â†‘                 â†‘
   è¾“å…¥3é€šé“         è¾“å‡º64é€šé“ âœ“


æ ¸å¿ƒè§„å¾‹ï¼ˆå®Œå…¨ä¸€æ ·ï¼ï¼‰:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
è¾“å‡ºé€šé“æ•° = å·ç§¯æ ¸ä¸ªæ•°

æ¯ä¸ªå·ç§¯æ ¸:
  - å½¢çŠ¶: [kernel_h, kernel_w, input_channels]
  - äº§ç”Ÿ: 1ä¸ªè¾“å‡ºé€šé“
  - æ— è®ºè¾“å…¥å¤šå°‘é€šé“ï¼Œè¾“å‡ºå°±æ˜¯1ä¸ªï¼
""")

# ============================================
# ä»£ç éªŒè¯ä¸¤ä¸ªæ¡ˆä¾‹
# ============================================
import torch
import torch.nn as nn

print("\n" + "=" * 70)
print("ä»£ç éªŒè¯")
print("=" * 70)

# æ¡ˆä¾‹1: MNIST (1â†’6)
print("\nã€æ¡ˆä¾‹1: MNISTé»‘ç™½å›¾ã€‘")
conv_mnist = nn.Conv2d(in_channels=1, out_channels=6, kernel_size=5)
x_mnist = torch.randn(1, 1, 28, 28)
out_mnist = conv_mnist(x_mnist)

print(f"è¾“å…¥: {x_mnist.shape}")
print(f"  - 1é€šé“ (ç°åº¦)")
print(f"  - 28Ã—28 å°ºå¯¸")
print(f"è¾“å‡º: {out_mnist.shape}")
print(f"  - 6é€šé“ â† 6ä¸ªå·ç§¯æ ¸ âœ“")
print(f"  - 24Ã—24 å°ºå¯¸ (28-5+1=24)")

print(f"\nå·ç§¯æ ¸å½¢çŠ¶: {conv_mnist.weight.shape}")
print(f"  - (6, 1, 5, 5)")
print(f"     â†‘  â†‘  â†‘  â†‘")
print(f"     â”‚  â”‚  â”‚  â””â”€ å·ç§¯æ ¸å®½åº¦")
print(f"     â”‚  â”‚  â””â”€â”€â”€â”€ å·ç§¯æ ¸é«˜åº¦")
print(f"     â”‚  â””â”€â”€â”€â”€â”€â”€â”€ è¾“å…¥é€šé“ (1)")
print(f"     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¾“å‡ºé€šé“ (6ä¸ªå·ç§¯æ ¸)")

# æ¡ˆä¾‹2: ImageNet (3â†’64)
print("\nã€æ¡ˆä¾‹2: ImageNetå½©è‰²å›¾ã€‘")
conv_imagenet = nn.Conv2d(in_channels=3, out_channels=64, kernel_size=7, 
                          stride=2, padding=3)
x_imagenet = torch.randn(1, 3, 224, 224)
out_imagenet = conv_imagenet(x_imagenet)

print(f"è¾“å…¥: {x_imagenet.shape}")
print(f"  - 3é€šé“ (RGB)")
print(f"  - 224Ã—224 å°ºå¯¸")
print(f"è¾“å‡º: {out_imagenet.shape}")
print(f"  - 64é€šé“ â† 64ä¸ªå·ç§¯æ ¸ âœ“")
print(f"  - 112Ã—112 å°ºå¯¸")

print(f"\nå·ç§¯æ ¸å½¢çŠ¶: {conv_imagenet.weight.shape}")
print(f"  - (64, 3, 7, 7)")
print(f"     â†‘   â†‘  â†‘  â†‘")
print(f"     â”‚   â”‚  â”‚  â””â”€ å·ç§¯æ ¸å®½åº¦")
print(f"     â”‚   â”‚  â””â”€â”€â”€â”€ å·ç§¯æ ¸é«˜åº¦")
print(f"     â”‚   â””â”€â”€â”€â”€â”€â”€â”€ è¾“å…¥é€šé“ (3)")
print(f"     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¾“å‡ºé€šé“ (64ä¸ªå·ç§¯æ ¸)")

# ============================================
# é€šç”¨è§„å¾‹æ€»ç»“
# ============================================
print("\n" + "=" * 70)
print("é€šç”¨è§„å¾‹ï¼ˆé“å¾‹ï¼ï¼‰")
print("=" * 70)

print("""
Conv2d(in_channels=C_in, out_channels=C_out, kernel_size=K)

å·ç§¯æ ¸æƒé‡å½¢çŠ¶:
  (C_out, C_in, K, K)
   â†‘      â†‘     â†‘  â†‘
   â”‚      â”‚     â”‚  â””â”€ å·ç§¯æ ¸å®½åº¦
   â”‚      â”‚     â””â”€â”€â”€â”€ å·ç§¯æ ¸é«˜åº¦
   â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¾“å…¥é€šé“æ•°
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¾“å‡ºé€šé“æ•° = å·ç§¯æ ¸ä¸ªæ•°

ä¾‹å­:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç½‘ç»œ      â”‚  è¾“å…¥é€šé“â”‚  è¾“å‡ºé€šé“  â”‚  å·ç§¯æ ¸å½¢çŠ¶    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ LeNet C1    â”‚    1     â”‚     6      â”‚  (6, 1, 5, 5)  â”‚
â”‚ LeNet C3    â”‚    6     â”‚    16      â”‚ (16, 6, 5, 5)  â”‚
â”‚ DenseNetåˆå§‹â”‚    3     â”‚    64      â”‚ (64, 3, 7, 7)  â”‚
â”‚ ResNetåˆå§‹  â”‚    3     â”‚    64      â”‚ (64, 3, 7, 7)  â”‚
â”‚ VGGç¬¬1å±‚    â”‚    3     â”‚    64      â”‚ (64, 3, 3, 3)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è§„å¾‹:
  âœ“ è¾“å‡ºé€šé“æ•° = å·ç§¯æ ¸ä¸ªæ•° (æ°¸è¿œï¼)
  âœ“ æ¯ä¸ªå·ç§¯æ ¸çš„æ·±åº¦ = è¾“å…¥é€šé“æ•°
  âœ“ æ¯ä¸ªå·ç§¯æ ¸äº§ç”Ÿ1ä¸ªè¾“å‡ºé€šé“
  
æ— è®ºè¾“å…¥æ˜¯:
  â€¢ 1é€šé“(ç°åº¦å›¾)
  â€¢ 3é€šé“(RGB)
  â€¢ 64é€šé“(ä¸­é—´å±‚ç‰¹å¾)
  â€¢ 1024é€šé“(æ·±å±‚ç‰¹å¾)
  
è§„å¾‹éƒ½ä¸€æ ·ï¼
""")

# ============================================
# å•ä¸ªå·ç§¯æ ¸çš„å·¥ä½œåŸç†
# ============================================
print("\n" + "=" * 70)
print("å•ä¸ªå·ç§¯æ ¸å¦‚ä½•å·¥ä½œï¼Ÿ")
print("=" * 70)

print("""
ä¾‹å­: Conv2d(3 â†’ 64, kernel=7)

å·ç§¯æ ¸1 çš„å½¢çŠ¶: [7, 7, 3]
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Ré€šé“å·ç§¯æ ¸  â”‚ 7Ã—7
  â”‚ Gé€šé“å·ç§¯æ ¸  â”‚ 7Ã—7
  â”‚ Bé€šé“å·ç§¯æ ¸  â”‚ 7Ã—7
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å·¥ä½œè¿‡ç¨‹:
1. å¯¹Ré€šé“å·ç§¯ â†’ ç»“æœ1
2. å¯¹Gé€šé“å·ç§¯ â†’ ç»“æœ2  
3. å¯¹Bé€šé“å·ç§¯ â†’ ç»“æœ3
4. ä¸‰ä¸ªç»“æœç›¸åŠ  â†’ è¾“å‡ºç‰¹å¾å›¾1 âœ“

å·ç§¯æ ¸2ã€å·ç§¯æ ¸3 ... å·ç§¯æ ¸64:
  â†’ åŒæ ·çš„è¿‡ç¨‹
  â†’ ä½†æƒé‡ä¸åŒ
  â†’ å­¦ä¹ ä¸åŒçš„ç‰¹å¾

64ä¸ªå·ç§¯æ ¸ = 64ä¸ªè¾“å‡ºç‰¹å¾å›¾ = 64é€šé“ï¼
""")

# ============================================
# ä½ çš„ç†è§£å®Œå…¨æ­£ç¡®ï¼
# ============================================
print("\n" + "=" * 70)
print("âœ“ ä½ çš„ç†è§£å®Œå…¨æ­£ç¡®ï¼")
print("=" * 70)

print("""
ä½ è¯´çš„:
"è¾“å…¥é€šé“ä¸º1æ—¶ï¼Œè¾“å‡ºé€šé“ä¸º6ï¼Œå°±æ˜¯6ä¸ªå·ç§¯æ ¸"

è¿™ä¸ªç†è§£ 100% æ­£ç¡®ï¼âœ“âœ“âœ“

æ— è®ºæ˜¯:
  â€¢ LeNet (1â†’6)
  â€¢ DenseNet (3â†’64)
  â€¢ ResNet (64â†’128)
  â€¢ ä»»ä½•å·ç§¯å±‚

åŸç†å®Œå…¨ä¸€æ ·:
  è¾“å‡ºé€šé“æ•° = å·ç§¯æ ¸ä¸ªæ•°

è¿™æ˜¯å·ç§¯ç¥ç»ç½‘ç»œæœ€åŸºæœ¬çš„é“å¾‹ï¼
ä½ å·²ç»æŒæ¡äº†æ ¸å¿ƒåŸç†ï¼ğŸ‘
""")

print("\n" + "=" * 70)
print("Conv1d: ä¸€ç»´å·ç§¯ (åºåˆ—æ•°æ®)")
print("=" * 70)

# åˆ›å»º1då·ç§¯
conv1d = nn.Conv1d(
    in_channels=128,    # è¾“å…¥ç‰¹å¾ç»´åº¦
    out_channels=256,   # è¾“å‡ºç‰¹å¾ç»´åº¦
    kernel_size=3       # å·ç§¯æ ¸å¤§å°(åªæœ‰1ä¸ªç»´åº¦)
)

# è¾“å…¥: æ—¶é—´åºåˆ—æ•°æ®
# ä¾‹å¦‚: 32ä¸ªå¥å­, æ¯ä¸ªè¯128ç»´embedding, åºåˆ—é•¿åº¦100
x_1d = torch.randn(32, 128, 100)

output_1d = conv1d(x_1d)

print(f"\nè¾“å…¥å½¢çŠ¶: {x_1d.shape}")
print(f"  - batch_size: 32")
print(f"  - channels: 128 (ç‰¹å¾ç»´åº¦)")
print(f"  - length: 100 (åºåˆ—é•¿åº¦)")

print(f"\nè¾“å‡ºå½¢çŠ¶: {output_1d.shape}")
print(f"  - batch_size: 32")
print(f"  - channels: 256")
print(f"  - length: 98 (100-3+1)")

print(f"\nåº”ç”¨åœºæ™¯:")
print(f"  â€¢ æ–‡æœ¬åˆ†ç±» (TextCNN)")
print(f"  â€¢ æ—¶é—´åºåˆ—é¢„æµ‹")
print(f"  â€¢ éŸ³é¢‘å¤„ç†")
print(f"  â€¢ ä¼ æ„Ÿå™¨æ•°æ®åˆ†æ")

print("\n" + "=" * 70)
print("Conv2d: äºŒç»´å·ç§¯ (å›¾åƒæ•°æ®)")
print("=" * 70)

# åˆ›å»º2då·ç§¯
conv2d = nn.Conv2d(
    in_channels=3,      # RGB
    out_channels=64,    # 64ä¸ªç‰¹å¾å›¾
    kernel_size=3       # 3Ã—3å·ç§¯æ ¸
)

# è¾“å…¥: å›¾åƒæ•°æ®
x_2d = torch.randn(32, 3, 224, 224)

output_2d = conv2d(x_2d)

print(f"\nè¾“å…¥å½¢çŠ¶: {x_2d.shape}")
print(f"  - batch_size: 32")
print(f"  - channels: 3 (RGB)")
print(f"  - height: 224")
print(f"  - width: 224")

print(f"\nè¾“å‡ºå½¢çŠ¶: {output_2d.shape}")
print(f"  - batch_size: 32")
print(f"  - channels: 64")
print(f"  - height: 222")
print(f"  - width: 222")

print(f"\nåº”ç”¨åœºæ™¯:")
print(f"  â€¢ å›¾åƒåˆ†ç±» (ResNet, DenseNet)")
print(f"  â€¢ ç›®æ ‡æ£€æµ‹ (YOLO, Faster R-CNN)")
print(f"  â€¢ è¯­ä¹‰åˆ†å‰² (U-Net, DeepLab)")
print(f"  â€¢ å›¾åƒç”Ÿæˆ (GAN, VAE)")

print("\n" + "=" * 70)
print("Conv3d: ä¸‰ç»´å·ç§¯ (ä½“ç§¯/è§†é¢‘æ•°æ®)")
print("=" * 70)

# åˆ›å»º3då·ç§¯
conv3d = nn.Conv3d(
    in_channels=3,      # RGB
    out_channels=64,    # 64ä¸ªç‰¹å¾å›¾
    kernel_size=3       # 3Ã—3Ã—3å·ç§¯æ ¸
)

# è¾“å…¥: è§†é¢‘æ•°æ®
# 16ä¸ªè§†é¢‘clip, RGB, 16å¸§, æ¯å¸§112Ã—112
x_3d = torch.randn(16, 3, 16, 112, 112)

output_3d = conv3d(x_3d)

print(f"\nè¾“å…¥å½¢çŠ¶: {x_3d.shape}")
print(f"  - batch_size: 16")
print(f"  - channels: 3 (RGB)")
print(f"  - depth: 16 (æ—¶é—´ç»´åº¦/å¸§æ•°)")
print(f"  - height: 112")
print(f"  - width: 112")

print(f"\nè¾“å‡ºå½¢çŠ¶: {output_3d.shape}")
print(f"  - batch_size: 16")
print(f"  - channels: 64")
print(f"  - depth: 14")
print(f"  - height: 110")
print(f"  - width: 110")

print(f"\nåº”ç”¨åœºæ™¯:")
print(f"  â€¢ è§†é¢‘åˆ†ç±» (C3D, I3D)")
print(f"  â€¢ åŠ¨ä½œè¯†åˆ«")
print(f"  â€¢ 3DåŒ»å­¦å›¾åƒåˆ†æ (CT, MRI)")
print(f"  â€¢ ç‚¹äº‘å¤„ç†")

print("\n" + "=" * 70)
print("å·ç§¯æ ¸å½¢çŠ¶å¯¹æ¯”")
print("=" * 70)

# è·å–å·ç§¯æ ¸æƒé‡
print("\nConv1d å·ç§¯æ ¸:")
print(f"å½¢çŠ¶: {conv1d.weight.shape}")
print(f"  (out_channels, in_channels, kernel_length)")
print(f"  ({conv1d.weight.shape[0]}, {conv1d.weight.shape[1]}, {conv1d.weight.shape[2]})")

print("\nConv2d å·ç§¯æ ¸:")
print(f"å½¢çŠ¶: {conv2d.weight.shape}")
print(f"  (out_channels, in_channels, kernel_height, kernel_width)")
print(f"  ({conv2d.weight.shape[0]}, {conv2d.weight.shape[1]}, {conv2d.weight.shape[2]}, {conv2d.weight.shape[3]})")

print("\nConv3d å·ç§¯æ ¸:")
print(f"å½¢çŠ¶: {conv3d.weight.shape}")
print(f"  (out_channels, in_channels, kernel_depth, kernel_height, kernel_width)")
print(f"  ({conv3d.weight.shape[0]}, {conv3d.weight.shape[1]}, {conv3d.weight.shape[2]}, {conv3d.weight.shape[3]}, {conv3d.weight.shape[4]})")

print("""
è§„å¾‹:
  Conv1d: å·ç§¯æ ¸æ˜¯ 1D çš„ (åªæœ‰length)
  Conv2d: å·ç§¯æ ¸æ˜¯ 2D çš„ (height Ã— width)
  Conv3d: å·ç§¯æ ¸æ˜¯ 3D çš„ (depth Ã— height Ã— width)
  
ç©ºé—´ç»´åº¦å°±æ˜¯å·ç§¯æ ¸çš„ç»´åº¦ï¼
""")